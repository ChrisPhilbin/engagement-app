<app-loading *ngIf="isLoading"></app-loading>

<a [routerLink]="['/employees/new']"><p-button label="New employee" [style]="{'margin-right': '8px'}"></p-button></a>
<button type="text" pButton label="Filter" (click)="op.toggle($event)" icon="pi pi-filter"></button>
<p-overlayPanel #op [showCloseIcon]="true">
  <ng-template pTemplate>
    <input placeholder="Filter by name..." [disabled]="filterByBirthday || filterByUpcomingAnniversaries || filterByOverdueInteractions" type="text" [(ngModel)]="searchTerm" (ngModelChange)="onFilterChange($event)" class="border-2 p-4 m-2 font-lg block">
    <p-toggleButton [disabled]="filterByOverdueInteractions || filterByUpcomingAnniversaries" [(ngModel)]="filterByBirthday" (click)="onFilterByBirthday()" onLabel="Upcoming birthdays" offLabel="Upcoming birthdays" onIcon="pi pi-check" offIcon="pi pi-times" [style]="{'margin-bottom': '12px', 'display': 'block'}"></p-toggleButton>
    <p-toggleButton [disabled]="filterByBirthday || filterByUpcomingAnniversaries"  [(ngModel)]="filterByOverdueInteractions" (click)="onFilterByOverdueInteractions()" onLabel="Overdue Interactions" offLabel="Overdue Interactions" onIcon="pi pi-check" offIcon="pi pi-times" [style]="{'margin-bottom': '12px', 'display': 'block'}"></p-toggleButton>
    <p-toggleButton [disabled]="filterByBirthday || filterByOverdueInteractions"  [(ngModel)]="filterByUpcomingAnniversaries" (click)="onFilterByUpcomingAnniversaries()" onLabel="Upcoming Anniversaries" offLabel="Upcoming Anniversaries" onIcon="pi pi-check" offIcon="pi pi-times" [style]="{'margin-bottom': '12px', 'display': 'block'}"></p-toggleButton>
  </ng-template>
</p-overlayPanel>
<p-toast position="top-right"></p-toast>

<!-- <span class="text-center text-red-600">
  <p *ngIf="searchTerm">Currently filtering by name</p>
  <p *ngIf="filterByBirthday">Currently filtering by upcoming birthdays</p>
  <p *ngIf="filterByOverdueInteractions">Currently filtering by overdue interactions</p>
  <p *ngIf="filterByUpcomingAnniversaries">Currently filtering by upcoming anniversaries</p>
</span> -->
  <!-- <div class="grid grid-cols-1 md:grid-cols-4 align-middle">
    <input [disabled]="filterByBirthday || filterByUpcomingAnniversaries || filterByOverdueInteractions" type="text" [ngModel]="searchTerm" (ngModelChange)="onFilterChange($event)" class="border-2 p-4 m-2 font-lg inline">
    <p-toggleButton [disabled]="filterByOverdueInteractions || filterByUpcomingAnniversaries" [(ngModel)]="filterByBirthday" (click)="onFilterByBirthday()" onLabel="Upcoming birthdays" offLabel="Upcoming birthdays" onIcon="pi pi-check" offIcon="pi pi-times" [style]="{'margin-right': '12px', 'display': 'inline'}"></p-toggleButton>
    <p-toggleButton [disabled]="filterByBirthday || filterByUpcomingAnniversaries"  [(ngModel)]="filterByOverdueInteractions" (click)="onFilterByOverdueInteractions()" onLabel="Overdue Interactions" offLabel="Overdue Interactions" onIcon="pi pi-check" offIcon="pi pi-times" [style]="{'margin-right': '12px', 'display': 'inline'}"></p-toggleButton>
    <p-toggleButton [disabled]="filterByBirthday || filterByOverdueInteractions"  [(ngModel)]="filterByUpcomingAnniversaries" (click)="onFilterByUpcomingAnniversaries()" onLabel="Upcoming Anniversaries" offLabel="Upcoming Anniversaries" onIcon="pi pi-check" offIcon="pi pi-times" [style]="{'margin-right': '12px', 'display': 'inline'}"></p-toggleButton>
  </div> -->
  <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-8">
  <p-card *ngFor="let employee of employees" [header]="employee.firstName + ' ' + employee.lastName" [style]="{'margin-bottom': '2em'}">
    <ng-template pTemplate="header">
        
    </ng-template>
      <strong>Birthday:</strong> {{ employee.birthDate | date: "MMMM d" }}<br />
      <strong>Hire date:</strong> {{ employee.hireDate | date: "MMMM d" }}<br />
      <strong>Last interaction:</strong> {{ employee.lastInteraction | date: "fullDate" }}<br />
      <strong>Interests: </strong><span *ngIf="!employee.interests.length">n/a</span><br />
      <ul>
        <span *ngIf="employee.interests.length">
          <li *ngFor="let interest of employee.interests; let isLast=last" class="inline">
            {{ interest }}{{ isLast ? '' : ', ' }}
          </li>
        </span>
      </ul>
    <ng-template pTemplate="footer">
      <a [routerLink]="['/employees', employee.employeeId]"><p-button label="Details" icon="pi pi-user-edit"></p-button></a>
      <p-button label="Remove" icon="pi pi-trash" styleClass="p-button-secondary" [style]="{'margin-left': '.5em'}"></p-button>
    </ng-template>
  </p-card>
</div>

<!-- <div class="container">
  <a [routerLink]="['/employees/new']"><p-button label="New employee"></p-button></a>
  <table
    class="w-full flex flex-row flex-no-wrap sm:bg-white rounded-lg overflow-hidden sm:shadow-lg my-5"
  >
    <thead class="text-white">
      <tr
        class="bg-teal-400 flex flex-col flex-no wrap sm:table-row rounded-l-lg sm:rounded-none mb-2 sm:mb-2"
        *ngFor="let _ of employees"
      >
        <th class="p-3 text-left">Name</th>
        <th class="p-3 text-left">Interests</th>
        <th class="p-3 text-left">Birthday</th>
        <th class="p-3 text-left">Hire Date</th>
        <th class="p-3 text-left">Last Interaction</th>
        <th class="p-3 text-left">Actions</th>
      </tr>
    </thead>
    <tbody class="flex-1 sm:flex-none">
      <tr
        class="flex flex-col flex-no wrap sm:table-row mb-2 sm:mb-2 hover:cursor-pointer"
        *ngFor="let employee of employees"
        (click)="editEmployee(employee.employeeId)"
      >
        <td class="border-grey-light border hover:bg-gray-100 p-3">
          {{ employee.firstName + " " + employee.lastName }}
        </td>
        <td class="border-grey-light border hover:bg-gray-100 p-3 truncate">
          <ul>
            <span *ngIf="employee.interests.length">
              <li *ngFor="let interest of employee.interests; let isLast=last" class="inline">
                {{ interest }}{{ isLast ? '' : ', ' }}
              </li>
            </span>
            <li *ngIf="!employee.interests.length" class="text-gray-300">
              n/a
            </li>
          </ul>
        </td>
        <td
          class="border-grey-light border hover:bg-gray-100 p-3"
          [ngClass]="employee.birthDate ? '' : 'text-gray-300'"
        >
          {{
            employee.birthDate
              ? (employee.birthDate | date: "MMMM d")
              : "n/a"
          }}
        </td>
        <td
          class="border-grey-light border hover:bg-gray-100 p-3"
          [ngClass]="employee.hireDate ? '' : 'text-gray-300'"
        >
          {{
            employee.hireDate ? (employee.hireDate | date: "fullDate") : "n/a"
          }}
        </td>
        <td
          class="border-grey-light border hover:bg-gray-100 p-3"
          [ngClass]="employee.lastInteraction ? '' : 'text-gray-300'"
        >
          {{
            employee.lastInteraction
              ? (employee.lastInteraction | date: "fullDate")
              : "n/a"
          }}
        </td>
        <td
          class="border-grey-light border hover:bg-gray-100 p-3 text-red-400 hover:text-red-600 hover:font-medium cursor-pointer"
          (click)="(null)"
        >
          Edit
        </td>
      </tr>
    </tbody>
  </table>
</div> -->
